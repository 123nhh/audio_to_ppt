# 自动歌词 PPT 生成器 (LyricsGen)

## 1. 工具简介

本工具是一个基于 Python 的自动化脚本，用于将本地音频文件（`.mp3`, `.flac`, `.wav`, `.m4a`）批量转换为 PowerPoint (`.pptx`) 演示文稿。在原有基础排版功能上，新增了 **AI 智能语义分析**。

**核心功能：**

* **🤖 AI 智能清洗**：自动调用 AI 接口，精准剔除歌词头部的制作人员名单（作词/编曲等）和尾部的推广废话，只保留纯净歌词。
* **🚫 纯音乐检测**：自动识别“纯音乐”标签或无实际内容的歌词，智能切换模式，仅生成精美封面，不生成空白页。
* **🎨 美观排版**：自动提取内嵌封面生成高斯模糊背景，添加遮罩层，保持封面与歌名始终置顶。
* **⚙️ 交互式配置**：首次运行自动引导配置 API Key，无需手动修改代码。
* **🚀 多线程加速**：利用多核 CPU 并发处理，大幅缩短批量转换时的等待时间。
* **🧹 自动扫尾**：运行结束后自动清理所有临时图片文件，保持目录整洁。

---

## 2. 使用方式 (二选一)

你可以选择直接运行打包好的程序，也可以运行源代码。

### 方式 A：直接运行 (推荐)
无需安装 Python 环境。
1. 下载 Release 中的 `.exe` 可执行文件。
2. 将 `.exe` 文件放入包含音频文件的文件夹中。

### 方式 B：源码运行
如果你需要修改代码，请确保安装了 Python 环境（建议 3.8+）。

**安装依赖库：**
```bash
pip install openai python-pptx mutagen Pillow

```

*(如果下载慢，请尝试国内源：`pip install openai python-pptx mutagen Pillow -i https://pypi.tuna.tsinghua.edu.cn/simple`)*

---

## 3. 文件准备

把程序（`.exe` 或 `.py`）和音频文件放在同一个文件夹下即可。

---

## 4. 如何使用

### 第一步：准备音频文件

确保你的音频文件中已经包含了**元数据（Metadata）**。

* **必须有**：内嵌歌词（Unsynced Lyrics / USLT）、封面图。
* *提示：如果生成的 PPT 没有歌词或封面，请使用 `Mp3tag` 等软件检查音频标签。*

### 第二步：运行程序

双击运行 `.exe` 文件，或在命令行运行：

```bash
python audio_to_ppt.py

```

**首次运行配置（仅需一次）：**
程序会自动检测是否配置了 AI。如果没有，会提示你输入：

1. **是否开启 AI 清洗** (y/n)
2. **API Key** (必填)
3. **接口地址** (默认 OpenAI 官方，可改用 DeepSeek/Kimi 等中转地址)
4. **模型名称** (如 gpt-3.5-turbo)

配置完成后会自动生成 `ai_config.json` 文件，下次运行将自动读取。

### 第三步：查看结果

* 程序会自动扫描当前目录下的音频文件。
* 你会看到类似以下的进度提示：
```text
[扫描] 发现 5 个文件 | 模式：交互配置 + 纯音乐过滤 + 自动清理残留

[歌曲A] [处理] 正在分析歌词...
[歌曲A] [AI] 清洗成功 (尝试 1/3)
[歌曲A] [完成] PPT已生成
...
[清理] 已自动清理 12 个残留的临时文件。

```


* 完成后，打开自动生成的 `output` 文件夹，即可看到对应的 PPTX 文件。

---

## 5. 常见问题 (Q&A)

**Q1: 为什么生成的 PPT 只有一张封面，没有歌词页？**

> **A:** 这是新功能。程序检测到该歌曲是 **纯音乐 (Instrumental)**，或者 AI 分析后发现歌词内容为空，为了美观，会自动跳过生成空白的歌词页。

**Q2: 我输错了 API Key，或者想更换模型怎么办？**

> **A:** 请直接删除文件夹下的 `ai_config.json` 文件。再次运行程序时，配置向导会重新出现。

**Q3: 为什么有的歌曲处理失败了？**

> **A:** 程序会自动跳过损坏的文件。常见原因包括：
> * 封面图数据损坏（程序会跳过封面，只生成文字）。
> * 文件权限被占用（请确保歌曲没有在播放器中播放）。
> 
> 

**Q4: AI 清洗失败会怎样？**

> **A:** 程序内置了重试机制（默认 3 次）。如果 AI 依然无法连接或报错，程序会**自动降级**，使用原始的正则表达式清洗歌词，确保 PPT 能生成，只是可能残留少量废话。

---

## 6. 免责声明

本工具仅供学习交流使用。

* 生成的 `ai_config.json` 包含你的 API Key，请妥善保管，**切勿分享给他人**。
* 本工具不会上传你的音频文件，仅上传歌词文本至 AI 接口进行处理。

```

```
