# 音频转 PPT 批量生成

## 1\. 工具简介

本工具是一个基于 Python 的自动化脚本，用于将本地音频文件（`.mp3`, `.flac`, `.wav`, `.m4a`）批量转换为 PowerPoint (`.pptx`) 演示文稿。

**核心功能：**

  * **自动提取信息**：读取音频文件的 ID3/Vorbis 标签，提取 **歌名、歌手、内嵌歌词** 和 **封面图**。
  * **美观排版**：自动生成高斯模糊背景，添加遮罩，并将歌词自动分页排版。
  * **多线程加速**：利用多核 CPU 并发处理，大幅缩短批量转换时的等待时间。
  * **防冲突机制**：拥有独立的文件锁和随机临时文件名，确保转换过程稳定不崩溃。

-----

## 2\. 环境准备

在使用之前，请确保你的电脑上安装了 Python 环境。

### 2.1 安装 Python

如果你还没有安装 Python，请前往 [Python 官网](https://www.python.org/) 下载并安装（建议版本 3.8 或更高）。

### 2.2 安装依赖库


```bash
pip install python-pptx mutagen Pillow
```

*(如果下载慢，请尝试使用国内源： `pip install python-pptx mutagen Pillow -i https://pypi.tuna.tsinghua.edu.cn/simple`)*

-----

## 3\. 文件

把程序和音频文件放在同一个文件夹下即可
-----

## 4\. 如何使用

### 第一步：准备音频文件

确保你的音频文件中已经包含了**元数据（Metadata）**。

  * **必须有**：内嵌歌词（Unsynced Lyrics / USLT）、封面图。
  * *提示：如果生成的 PPT 没有歌词或封面，通常是因为音频文件本身没有这些数据。你可以使用 `Mp3tag` 或 `Foobar2000` 等软件检查并编辑音频标签。*

### 第二步：运行脚本

<!-- end list -->

```bash
python audio_to_ppt.py
```

### 第三步：查看结果

  * 程序会自动扫描当前目录下的音频文件。
  * 你会看到类似以下的进度提示：
    ```text
    🔍 发现 5 个文件，准备进行多线程处理...
    ✅ [完成] 歌曲1.mp3
    ✅ [完成] 歌曲2.flac
    ...
    🎉 全部处理完毕！
    ```
  * 完成后，打开自动生成的 `output` 文件夹，即可看到对应的 PPTX 文件。

-----

## 5\. 常见问题 (Q\&A)

**Q1: 为什么生成的 PPT 里只有背景，没有歌词？**

> **A:** 这说明你的音频文件中没有读取到内嵌歌词。本工具**不会**自动联网下载歌词，它只读取文件里已有的信息。请先用标签编辑软件（如 Mp3tag）把歌词写入音频文件。

**Q2: 为什么有的歌曲处理失败了？**

> **A:** 程序会自动跳过损坏的文件。常见原因包括：
>
>   * 封面图数据损坏（程序会跳过封面，只生成文字）。
>   * 文件权限被占用（请确保歌曲没有在播放器中播放）。

**Q3: 如何修改同时处理的数量？**

> **A:** 用记事本打开代码，找到 `batch_process` 函数中的 `max_workers=6`，将数字 `6` 改为你想要的并行数量（建议不超过你的 CPU 核心数）。

**Q4: 生成的 PPT 能直接用于投影吗？**

> **A:** 可以。生成比例为 **16:9**（宽屏）。字体默认为“微软雅黑”，如果在 Mac 上使用，可能需要系统自动替换字体。

-----

## 6\. 免责声明

本工具仅供学习交流使用。生成的 PPT 字体、版式依赖于 `python-pptx` 库的默认行为，复杂排版需求建议手动微调生成的 PPT 文件。

-----
